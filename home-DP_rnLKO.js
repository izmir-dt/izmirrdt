import{u as S,r as t,a as T,j as e,S as B,X as O}from"./index-BiS_08CB.js";import{p as D,g as L,i as y,t as p,c as P}from"./theater-BlRsLV9p.js";import{S as f}from"./skeleton-CIwMLOW5.js";import{I as $}from"./input-D4NQlLM0.js";import{E as K}from"./excel-dialog-BPx1tPwP.js";import{B as k}from"./baby-DmBnwbxH.js";import{T as U}from"./theater-CXqowHoh.js";import{U as A}from"./users-B7ucXcX7.js";import{R as I}from"./rows-3-Bj35E-JI.js";import{C as z}from"./chevron-left-aY-Dd53K.js";import{D as F}from"./download-DUYADPWz.js";import"./copy-dkgLgat7.js";function V({playName:n,rows:m,onBack:d,onExcel:g}){const[,u]=S(),h=t.useMemo(()=>{const a=new Map;return m.forEach(o=>{const l=o.kategori||"Diğer";a.has(l)||a.set(l,[]),a.get(l).push(o)}),a},[m]),b=t.useMemo(()=>Array.from(h.keys()),[h]),j=t.useMemo(()=>{const a=new Set;return m.forEach(o=>{o.kisi.split(",").forEach(l=>{l.trim()&&a.add(l.trim())})}),a.size},[m]),N=y(n);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"shrink-0 flex items-center justify-between px-4 py-3 border-b border-border",style:{background:"hsl(var(--card))"},children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("button",{onClick:d,className:"p-1 rounded-lg hover:bg-muted transition-colors text-muted-foreground",children:e.jsx(z,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[e.jsx("h2",{className:"font-bold text-[14px] text-foreground",children:n}),N&&e.jsxs("span",{className:"text-[10px] font-semibold text-chart-4 bg-chart-4/10 px-1.5 py-0.5 rounded flex items-center gap-0.5",children:[e.jsx(k,{className:"w-2.5 h-2.5"}),"Ç.O"]})]}),e.jsxs("p",{className:"text-[11px] text-muted-foreground",children:[j," kişi  ·  ",m.length," kayıt"]})]})]}),e.jsxs("button",{onClick:g,className:"text-xs font-semibold px-2.5 py-1 rounded-lg border border-border hover:bg-muted transition-colors text-muted-foreground flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),"Excel"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-3",children:b.map(a=>{const o=h.get(a);return e.jsxs("div",{className:"rounded-xl border border-border overflow-hidden",style:{background:"hsl(var(--card))"},children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b border-border",style:{background:"hsl(var(--sidebar) / 0.5)"},children:[e.jsx("span",{className:`shrink-0 text-[10px] font-semibold px-1.5 py-0.5 rounded ${P(a)}`,children:a}),e.jsxs("span",{className:"text-[11px] text-muted-foreground",children:[o.length," kayıt"]})]}),e.jsx("div",{className:"px-3 py-2 space-y-1",children:o.map((l,i)=>e.jsxs("div",{className:"flex items-start gap-2 py-0.5",children:[e.jsx("span",{className:"text-[12px] font-semibold text-foreground cursor-pointer hover:underline leading-snug",onClick:()=>u(`/oyunlar?kisi=${encodeURIComponent(l.kisi)}`),title:"Kişi profiline git",children:l.kisi}),l.gorev&&e.jsxs("span",{className:"text-[11px] text-muted-foreground leading-snug",children:["— ",l.gorev]})]},i))})]},a)})})]})}function re(){S();const[n,m]=t.useState(null),[d,g]=t.useState(""),[u,h]=t.useState("all"),[b,j]=t.useState("list"),[N,a]=t.useState(!1),{data:o,isLoading:l}=T({queryKey:["/api/sheets","BÜTÜN OYUNLAR"],refetchOnMount:"always"}),i=t.useMemo(()=>o?D(o.headers,o.rows):[],[o]),v=t.useMemo(()=>L(i),[i]),E=t.useMemo(()=>{const s=new Set;return i.forEach(r=>r.kisi.split(",").forEach(x=>{x.trim()&&s.add(x.trim())})),s.size},[i]),w=t.useMemo(()=>{let s=v;if(u==="yetiskin"&&(s=s.filter(r=>!y(r.name))),u==="cocuk"&&(s=s.filter(r=>y(r.name))),d.trim()){const r=p(d.trim());s=s.filter(x=>p(x.name).includes(r)||i.filter(c=>c.oyun===x.name).some(c=>p(c.kisi).includes(r)||p(c.gorev).includes(r)||p(c.kategori).includes(r)))}return s},[v,d,u,i]),C=t.useMemo(()=>n?i.filter(s=>s.oyun===n):[],[i,n]),M=t.useCallback(s=>{m(s),j("detail")},[]),R=t.useCallback(()=>{j("list")},[]);return l?e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-72 shrink-0 border-r p-3 space-y-2",children:[e.jsx(f,{className:"h-9 w-full rounded-lg"}),e.jsx(f,{className:"h-7 w-full rounded-lg"}),[1,2,3,4,5,6,7].map(s=>e.jsx(f,{className:"h-12 rounded-lg"},s))]}),e.jsxs("div",{className:"flex-1 p-4 space-y-3",children:[e.jsx(f,{className:"h-12 w-80 rounded-lg"}),[1,2,3,4].map(s=>e.jsx(f,{className:"h-20 rounded-xl"},s))]})]}):e.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("div",{className:`${b==="detail"?"hidden":"flex"} md:flex flex-col w-full md:w-72 shrink-0 border-r border-border`,style:{background:"hsl(var(--card))"},children:[e.jsxs("div",{className:"px-3 py-2 border-b border-border shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground"}),e.jsx($,{"data-testid":"input-search-home",placeholder:"Oyun, kişi, görev ara…",value:d,onChange:s=>g(s.target.value),className:"pl-8 pr-7 h-8 text-[12px]"}),d&&e.jsx("button",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",onClick:()=>g(""),children:e.jsx(O,{className:"w-3 h-3"})})]}),e.jsx("div",{className:"flex gap-1 mt-2",children:["all","yetiskin","cocuk"].map(s=>e.jsx("button",{onClick:()=>h(s),className:"flex-1 py-1 text-[10px] font-bold rounded-md transition-all",style:u===s?{background:"hsl(var(--sidebar))",color:"hsl(var(--sidebar-primary))"}:{background:"hsl(var(--muted)/0.5)",color:"hsl(var(--muted-foreground))"},children:s==="all"?"Tümü":s==="yetiskin"?"Yetişkin":e.jsxs("span",{className:"flex items-center justify-center gap-0.5",children:[e.jsx(k,{className:"w-2.5 h-2.5"}),"Çocuk"]})},s))}),e.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1.5 px-0.5",children:[w.length," oyun",d&&e.jsxs("span",{className:"text-primary font-medium",children:[' · "',d,'"']})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:w.map(s=>{const r=n===s.name,x=y(s.name);return e.jsxs("button",{"data-testid":`play-item-${s.name}`,onClick:()=>M(s.name),className:"w-full text-left px-3 py-2.5 border-b border-border/50 transition-colors flex items-center gap-2",style:r?{background:"hsl(var(--sidebar))",color:"hsl(var(--sidebar-foreground))"}:{background:"transparent",color:"hsl(var(--foreground))"},onMouseEnter:c=>{r||(c.currentTarget.style.background="hsl(var(--muted))")},onMouseLeave:c=>{r||(c.currentTarget.style.background="transparent")},children:[e.jsx(U,{className:"w-3 h-3 shrink-0",style:r?{color:"hsl(var(--sidebar-primary))"}:{color:"hsl(var(--muted-foreground))"}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[e.jsx("span",{className:"text-[12px] font-semibold leading-snug truncate",style:r?{color:"hsl(var(--sidebar-foreground))"}:{},children:s.name}),x&&e.jsx(k,{className:"w-3 h-3 shrink-0",style:r?{color:"hsl(var(--sidebar-primary))"}:{color:"hsl(var(--chart-4))"}})]}),e.jsxs("p",{className:"text-[10px] mt-0.5 flex items-center gap-2",style:r?{color:"hsl(var(--sidebar-foreground) / 0.65)"}:{color:"hsl(var(--muted-foreground))"},children:[e.jsxs("span",{className:"flex items-center gap-0.5",children:[e.jsx(A,{className:"w-2.5 h-2.5"}),s.personelCount," kişi"]}),e.jsxs("span",{className:"flex items-center gap-0.5",children:[e.jsx(I,{className:"w-2.5 h-2.5"}),s.rowCount," satır"]})]})]})]},s.name)})})]}),e.jsx("div",{className:`${b==="list"?"hidden":"flex"} md:flex flex-1 flex-col min-w-0`,style:{background:"hsl(var(--background))"},children:n?e.jsx(V,{playName:n,rows:C,onBack:R,onExcel:()=>a(!0)}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground gap-3",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center",style:{background:"hsl(var(--sidebar))"},children:e.jsx("span",{className:"font-black text-xl",style:{color:"hsl(var(--sidebar-primary))"},children:"İDT"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Bir oyun seçin"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Sol panelden bir oyunu tıklayarak",e.jsx("br",{}),"kadro ve personel bilgisini görüntüleyin"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3 text-xs text-muted-foreground mt-2",children:[e.jsxs("span",{className:"bg-card border border-border rounded-lg px-3 py-1.5",children:[e.jsx("strong",{className:"text-foreground",children:v.length})," Oyun"]}),e.jsxs("span",{className:"bg-card border border-border rounded-lg px-3 py-1.5",children:[e.jsx("strong",{className:"text-foreground",children:E})," Kişi"]}),e.jsxs("span",{className:"bg-card border border-border rounded-lg px-3 py-1.5",children:[e.jsx("strong",{className:"text-foreground",children:i.length})," Kayıt"]})]})]})})]}),n&&e.jsx(K,{open:N,onClose:()=>a(!1),playName:n,rows:C})]})}export{re as default};
