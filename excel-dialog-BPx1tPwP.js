import{r as o,j as e,X as k}from"./index-BiS_08CB.js";import{c as g}from"./theater-BlRsLV9p.js";import{C as v}from"./download-DUYADPWz.js";import{C as w}from"./copy-dkgLgat7.js";function z({open:p,onClose:i,playName:j,rows:c,customHeaders:C,customTsvFn:l}){const h=o.useRef(null),[u,f]=o.useState(!1),n=o.useMemo(()=>{const r=new Set;return c.forEach(t=>{t.kategori&&r.add(t.kategori.trim())}),Array.from(r).sort((t,s)=>t.localeCompare(s,"tr"))},[c]),[d,m]=o.useState(new Set(n));o.useEffect(()=>{m(new Set(n))},[c]);const a=o.useMemo(()=>c.filter(r=>d.has(r.kategori.trim())),[c,d]),x=o.useMemo(()=>{if(l)return l();const r="Oyun	Kategori	Görev	Kişi",t=a.map(s=>`${s.oyun}	${s.kategori}	${s.gorev}	${s.kisi}`);return[r,...t].join(`
`)},[a,l]),y=()=>{navigator.clipboard.writeText(x).then(()=>{f(!0),setTimeout(()=>f(!1),2e3)}).catch(()=>{h.current?.select()})};if(o.useEffect(()=>{if(!p)return;const r=t=>{t.key==="Escape"&&i()};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[p,i]),!p)return null;const N=()=>{d.size===n.length?m(new Set):m(new Set(n))},b=n.length>0&&!l;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40 bg-black/40 backdrop-blur-[2px]",onClick:i}),e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onClick:i,children:e.jsxs("div",{className:"w-full max-w-[480px] max-h-[80vh] flex flex-col rounded-2xl overflow-hidden shadow-2xl",style:{background:"hsl(var(--card))",border:"1px solid hsl(var(--border))"},onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 shrink-0",style:{background:"hsl(var(--sidebar))",borderBottom:"1px solid hsl(var(--sidebar-border))"},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-[13px]",style:{color:"hsl(var(--sidebar-foreground))"},children:"Excel'e Aktar"}),e.jsx("p",{className:"text-[11px] mt-0.5",style:{color:"hsl(var(--sidebar-foreground) / 0.60)"},children:j})]}),e.jsx("button",{onClick:i,className:"p-1.5 rounded-lg hover:bg-white/10 transition-colors",style:{color:"hsl(var(--sidebar-foreground) / 0.65)"},children:e.jsx(k,{className:"w-4 h-4"})})]}),b&&e.jsxs("div",{className:"px-4 py-2.5 border-b border-border shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx("span",{className:"text-[10px] font-semibold text-muted-foreground uppercase tracking-wide",children:"Kategori Filtresi"}),e.jsx("button",{onClick:N,className:"text-[11px] text-primary hover:underline",children:d.size===n.length?"Tümünü Kaldır":"Tümünü Seç"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:n.map(r=>{const t=d.has(r);return e.jsx("button",{onClick:()=>{const s=new Set(d);t?s.delete(r):s.add(r),m(s)},className:`text-[10px] font-semibold px-1.5 py-0.5 rounded border transition-all ${t?`${g(r)} border-transparent`:"bg-transparent text-muted-foreground border-border opacity-40"}`,children:r},r)})})]}),e.jsxs("div",{className:"px-4 py-2 border-b border-border shrink-0 bg-muted/30 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[11px] text-muted-foreground",children:[e.jsx("strong",{className:"text-foreground",children:l?x.split(`
`).length-1:a.length})," satır",b&&e.jsxs(e.Fragment,{children:["  ·  ",e.jsx("strong",{className:"text-foreground",children:d.size}),"/",n.length," kategori"]})]}),e.jsx("span",{className:"text-[10px] text-muted-foreground/60",children:"İlk 6 satır önizleme"})]}),e.jsxs("div",{className:"flex-1 overflow-auto px-4 py-3 space-y-3 min-h-0",children:[!l&&a.length===0&&e.jsx("div",{className:"flex flex-col items-center justify-center h-20 text-muted-foreground gap-2",children:e.jsx("p",{className:"text-sm",children:"Hiçbir kategori seçili değil"})}),!l&&a.length>0&&e.jsx("div",{className:"overflow-x-auto rounded-lg border border-border",children:e.jsxs("table",{className:"w-full text-[11px]",children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"hsl(var(--sidebar))"},children:["Oyun","Kategori","Görev","Kişi"].map(r=>e.jsx("th",{className:"text-left px-3 py-2 font-bold whitespace-nowrap",style:{color:"hsl(var(--sidebar-primary))"},children:r},r))})}),e.jsxs("tbody",{children:[a.slice(0,6).map((r,t)=>e.jsxs("tr",{className:`border-t border-border/40 ${t%2===0?"":"bg-muted/20"}`,children:[e.jsx("td",{className:"px-3 py-1.5 font-medium text-foreground truncate max-w-[110px]",children:r.oyun}),e.jsx("td",{className:"px-3 py-1.5",children:e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded font-semibold ${g(r.kategori)}`,children:r.kategori})}),e.jsx("td",{className:"px-3 py-1.5 text-muted-foreground truncate max-w-[90px]",children:r.gorev}),e.jsx("td",{className:"px-3 py-1.5 text-foreground truncate max-w-[100px]",children:r.kisi})]},t)),a.length>6&&e.jsx("tr",{className:"border-t border-border/40 bg-muted/10",children:e.jsxs("td",{colSpan:4,className:"px-3 py-2 text-[10px] text-muted-foreground text-center",children:["… ve ",a.length-6," satır daha"]})})]})]})}),e.jsxs("div",{className:"rounded-lg border border-border bg-muted/20 px-3 py-2",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground mb-1",children:"Panoya kopyalanacak veri (TSV formatı):"}),e.jsx("textarea",{ref:h,readOnly:!0,value:x.slice(0,400)+(x.length>400?"…":""),onClick:()=>h.current?.select(),rows:3,className:"w-full text-[10px] font-mono bg-transparent focus:outline-none resize-none cursor-text text-muted-foreground",style:{userSelect:"text"}})]})]}),e.jsxs("div",{className:"px-4 py-3 border-t border-border shrink-0 flex items-center justify-between gap-3",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Kopyala → Excel'i aç → Ctrl+V"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:i,className:"px-3 py-1.5 text-xs font-medium rounded-lg border border-border hover:bg-muted transition-colors",children:"Kapat"}),e.jsxs("button",{onClick:y,className:"flex items-center gap-1.5 px-4 py-1.5 text-xs font-semibold rounded-lg text-white transition-all",style:{background:u?"hsl(142 70% 38%)":"hsl(155 65% 38%)"},children:[u?e.jsx(v,{className:"w-3.5 h-3.5"}):e.jsx(w,{className:"w-3.5 h-3.5"}),u?"Kopyalandı!":`${l?x.split(`
`).length-1:a.length} Satırı Kopyala`]})]})]})]})})]})}export{z as E};
